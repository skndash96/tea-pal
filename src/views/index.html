<html>

<head>
    <title> TEA pal | TNEA Counselling Details </title>

    <link rel="stylesheet" href="./main.css" />
</head>

<style>
    :root {
        --elevate: #ffffff22;
    }

    body {
        background: black;
        color: white;
    }

    header {
        padding: .5rem 1rem;
        background: var(--elevate);
    }

    form {
        width: fit-content;
        margin: 2rem auto;
        background: var(--elevate);
        padding: 2rem;
        max-width: 32rem;
        display: flex;
        flex-direction: column;
        gap: 1rem;
        line-height: 1.5rem;
    }

    form button {
        width: fit-content;
        padding: 0 .5rem
    }

    #result {
        padding: 2rem;
        margin: 0 2rem;
        border-top: 2px solid white;
    }

    #result table {
        /* table-layout: fixed; */
        border-collapse: collapse;
        border: 2px solid white;
    }

    #result table th {
        background: #ffffffaa;
        color: black;
        text-align: center;
        padding: 0 .5rem;
    }

    #result table tr>* {
        border: 2px solid white;
        border-top: none;
        border-bottom: none;
    }

    #result table td {
        padding: .5rem;
        word-wrap: break-word;
    }

    #result table tr:nth-child(odd) {
        background: var(--elevate);
    }

    #result td a {
        color: rgb(134, 178, 249);
    }#result td a:visited {
        color: rgb(61, 119, 212);
    }
</style>

<body>
    <header>
        <h1>TEA pal</12>
    </header>

    <div id="container">
        <form id="query" action="">
            <h2> Query by Cutoff </h2>
            <p>
                <strong>What is Cutoff?</strong>
                A parameter based on your HSC (Class XII) exam results that decides your admission into Engineering
                colleges via TNEA Counselling.
                <br /><br /> Cutoff mark in TNEA is calculated as
                <br /> <code>= (Marks in Maths) + (Half of Marks in Physics) + (Half of Marks in Chemistry) </code>
                <br />Max possible cutoff is 200.
            </p>
            <div>
                <label for="cutoff"> Cutoff </label>
                <input name="cutoff" class="classic" type="text" />
            </div>
            <button class="classic" type="submit">Query</button>

            <p>We have a collection of details of <!--data_length--> students and their respective colleges fetched from
                TNEA Ofiicial site. </p>
        </form>

        <div class="result_box" id="result">
            <span id="hint">Query Results:</span>

            <table></table>
        </div>
    </div>

    <script>
        window.branchMap = {"AD":"ARTIFICIAL INTELLIGENCE AND DATA SCIENCE","AE":"AERONAUTICAL ENGINEERING","AG":"AGRICULTURAL ENGINEERING","AL":"ARTIFICIAL INTELLIGENCE AND MACHINE LEARNING","AM":"COMPUTER SCIENCE AND ENGINEERING (ARTIFICIAL INTELLIGENCE AND MACHINE LEARNING)","AO":"AEROSPACE ENGINEERING","AP":"APPAREL TECHNOLOGY (SS)","AS":"AUTOMOBILE ENGINEERING (SS)","AT":"ARTIFICIAL INTELLIGENCE AND DATA SCIENCE (SS)","AU":"AUTOMOBILE ENGINEERING","BC":"BIO TECHNOLOGY AND BIO CHEMICAL ENGINEERING","BM":"BIO MEDICAL ENGINEERING","BP":"B.Plan","BS":"BIO TECHNOLOGY (SS)","BT":"BIO TECHNOLOGY","BY":"BIO MEDICAL ENGINEERING (SS)","CB":"COMPUTER SCIENCE AND BUSSINESS SYSTEM","CC":"CHEMICAL AND ELECTRO CHEMICAL  ENGINEERING (SS)","CD":"COMPUTER SCIENCE AND DESIGN","CE":"CIVIL  ENGINEERING","CF":"COMPUTER SCIENCE AND ENGINEERING (DATA SCIENCE)","CG":"COMPUTER SCIENCE AND ENGINEERING (ARTIFICIAL INTELLIGENCE AND MACHINE LEARNING) (SS)","CH":"CHEMICAL  ENGINEERING","CI":"COMPUTER SCIENCE AND ENGINEERING (INTERNET OF THINGS)","CJ":"M.Tech. COMPUTER SCIENCE AND ENGINEERING (Integrated 5 Years)","CL":"CHEMICAL  ENGINEERING (SS)","CM":"COMPUTER SCIENCE AND ENGINEERING (SS)","CN":"CIVIL  ENGINEERING (SS)","CO":"COMPUTER AND COMMUNICATION ENGINEERING","CR":"CERAMIC TECHNOLOGY (SS)","CS":"COMPUTER SCIENCE AND ENGINEERING","CT":"COMPUTER TECHNOLOGY","CW":"COMPUTER SCIENCE AND BUSINESS SYSTEM (SS)","CY":"CYBER SECURITY","CZ":"CIVIL AND STRUCTUTURAL ENGINEERING","EC":"ELECTRONICS AND COMMUNICATION ENGINEERING","EE":"ELECTRICAL AND ELECTRONICS ENGINEERING","EI":"ELECTRONICS AND INSTRUMENTATION ENGINEERING","EM":"ELECTRONICS AND COMMUNICATION ENGINEERING (SS)","EN":"ENVIRONMENTAL ENGINEERING","ES":"ELECTRICAL AND ELECTRONICS (SANDWICH) (SS)","ET":"ELECTRONICS AND TELECOMMUNICATION ENGINEERING","EY":"ELECTRICAL AND ELECTRONICS ENGINEERING (SS)","FD":"FOOD TECHNOLOGY","FS":"FOOD TECHNOLOGY (SS)","FT":"FASHION TECHNOLOGY","FY":"FASHION TECHNOLOGY (SS)","GI":"GEO INFORMATICS","HT":"HANDLOOM AND TEXTILE TECHNOLOGY","IB":"INDUSTRIAL BIO TECHNOLOGY","IC":"INSTRUMENTATION AND CONTROL ENGINEERING","IE":"INDUSTRIAL ENGINEERING","IM":"INFORMATION TECHNOLOGY (SS)","IN":"INDUSTRIAL ENGINEERING AND MANAGEMENT","IS":"INDUSTRIAL BIO TECHNOLOGY (SS)","IT":"INFORMATION TECHNOLOGY","IY":"INSTRUMENTATION AND CONTROL ENGINEERING (SS)","LE":"LEATHER TECHNOLOGY","MA":"MATERIAL SCIENCE AND ENGINEERING (SS)","MC":"MECHATRONICS","MD":"MEDICAL ELECTRONICS ENGINEERING","ME":"MECHANICAL ENGINEERING","MF":"MECHANICAL ENGINEERING (SS)","MG":"MECHATRONICS (SS)","MH":"MECHANICAL ENGINEERING (SANDWICH)","MI":"MINING ENGINEERING","MM":"MECHANICAL ENGINEERING (MANUFACTURING)","MN":"MANUFACTURING ENGINEERING","MO":"MECHANICAL AND MECHATRONICS ENGINEERING (ADDITIVE MANUFACTURING)","MR":"MARINE ENGINEERING","MS":"MECHANICAL ENGINEERING (SANDWICH) (SS)","MT":"METALLURGICAL ENGINEERING","MU":"MECHANICAL AND AUTOMATION ENGINEERING","MY":"METALLURGICAL ENGINEERING (SS)","MZ":"MECHATRONICS ENGINEERING","PA":"PLASTIC TECHNOLOGY","PC":"PETRO CHEMICAL TECHNOLOGY","PD":"PETRO CHEMICAL ENGINEERING","PE":"PETROLEUM ENGINEERING","PH":"PHARMACEUTICAL TECHNOLOGY","PM":"PHARMACEUTICAL TECHNOLOGY (SS)","PN":"PRODUCTION ENGINEERING (SS)","PP":"PETROLEUM ENGINEERING AND TECHNOLOGY (SS)","PR":"PRODUCTION ENGINEERING","PS":"PRODUCTION ENGINEERING (SANDWICH) (SS)","PT":"PRINTING AND PACKING TECHNOLOGY","RA":"ROBOTICS AND AUTOMATION (SS)","RM":"ROBOTICS AND AUTOMATION","RP":"RUBBER AND PLASTIC TECHNOLOGY","SB":"COMPUTER SCIENCE AND ENGINEERING (INTERNET OF THINGS AND CYBER SECURITY INCLUDING BLOCK CHAIN TECHNOLOGY)","SC":"COMPUTER SCIENCE AND ENGINEERING (CYBER SECURITY)","SE":"INFORMATION SCIENCE AND ENGINEERING","SF":"SAFETY AND FIRE ENGINEERING","TC":"TEXTILE CHEMISTRY","TS":"COMPUTER SCIENCE AND TECHNOLOGY","TT":"TEXTILE TECHNOLOGY (SS)","TX":"TEXTILE TECHNOLOGY","XC":"CIVIL ENGINEERING (TAMIL MEDIUM)","XM":"MECHANICAL ENGINEERING (TAMIL MEDIUM)","XS":"COMPUTER SCIENCE AND ENGINEERING (TAMIL)"};
    </script>

    <script>
        let form = document.getElementById("query");
        let table = document.querySelector("#result table");
        let hint = document.getElementById("hint");

        const fields = ["name", "cutoff", "rank", "category", "college", "college_name", "college_city", "branch"];

        form.addEventListener("submit", async (event) => {
            event.preventDefault();

            mark = form.querySelector("input[name=\'cutoff\']").value;

            if (!mark) return alert("Invalid Input");

            let response = await fetch("/query?limit=50&cutoff=" + mark);
            let data = await response.json();

            table.innerHTML = "";

            if (data.length) {
                let heading_row = document.createElement("tr");
                fields.forEach(f => {
                    let th = document.createElement("th");
                    th.textContent = f.toUpperCase();
                    heading_row.appendChild(th);
                });
                table.appendChild(heading_row);

                data.forEach((item) => {
                    let row = document.createElement("tr");
                    fields.forEach(f => {
                        let cell = document.createElement("td");
                        
                        if (f === "college_name") {
                            cell.innerHTML = `<a target="_blank" href="https://google.com/search?q=${encodeURI(item[f])}"> ${item[f]} </a>`
                        } else if (f === "branch") {
                            let abbr = window.branchMap[item[f]];
                            abbr = abbr
                                .split(/\s+/)
                                .map(w => w[0] + w.toLowerCase().substring(1))
                                .join(" ");
                            
                            cell.textContent = `${abbr} (${item[f]})`
                        } else {
                            cell.textContent = item[f];
                        }
                        row.appendChild(cell);
                    });
                    table.appendChild(row);
                });
            } else {
                hint.textContent = "None Found";
            }
        });
    </script>
</body>

</html>